<!doctype html>
<html lang="ru" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Arabic Letters — Книжка 1</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; padding: 0; }

    /* ✅ Главное: даём странице скролл, если по высоте не помещается */
    body { overflow-y: auto; }

    /* ✅ В альбомной ориентации у телефона делаем навигацию компактнее */
    @media (max-width: 767px) and (orientation: landscape) {
      #letters-mobile { max-height: 12vh !important; }   /* меньше высота блока букв */
      #card-image { max-height: 52vh !important; }       /* меньше картинка, чтобы влез плеер */
    }
  </style>
</head>

<body class="h-full">
  <div class="min-h-full w-full flex flex-col md:flex-row" style="background:#f5f5f5;">

    <!-- MOBILE -->
    <header class="md:hidden bg-white border-b border-gray-200 p-3">
      <div class="flex items-center justify-between">
        <div class="text-sm font-semibold text-gray-700">Книжка 1</div>
        <button id="toggle-nav"
                class="rounded-lg px-3 py-2 text-sm font-semibold"
                style="background:#f3f4f6;">
          Скрыть
        </button>
      </div>

      <div id="mobile-nav" class="mt-3">
        <div class="text-xs font-semibold uppercase tracking-wide text-gray-500">Буквы</div>

        <!-- 7 в ряд -->
        <div id="letters-mobile"
             class="mt-2 grid grid-cols-7 gap-1 overflow-y-auto"
             style="max-height:22vh;"></div>
      </div>
    </header>

    <!-- DESKTOP -->
    <aside class="hidden md:flex md:flex-col p-4 gap-4"
           style="width:240px;background:#fff;border-right:1px solid #e0e0e0;overflow-y:auto;">
      <div class="text-xs font-semibold uppercase tracking-wide text-gray-500">Книжка 1</div>
      <div id="letters-desktop" class="grid grid-cols-2 gap-2"></div>
    </aside>

    <!-- CARD -->
    <main class="flex-1 flex items-center justify-center p-3 md:p-8">
      <div class="w-full h-full flex flex-col items-center justify-center gap-3">
        <img id="card-image"
             src=""
             alt="Letter"
             class="w-full"
             style="max-height:68vh;object-fit:contain;" />

        <!-- ✅ Плеер всегда будет ниже картинки и доступен (если не влез — появится скролл страницы) -->
        <audio id="letter-audio" controls class="w-full max-w-md"></audio>

        <button id="stop-audio"
                class="px-4 py-2 rounded-lg text-sm font-semibold"
                style="background:#f3f4f6;">
          ⏹ Стоп
        </button>
      </div>
    </main>
  </div>

  <script>
    const book1 = [
      { label: "د", img: "Мишка.png",        audio: "мишка.mp3",        bg:"#E8D4B7", fg:"#4B2E1E" },
      { label: "ب", img: "Уточка.png",       audio: "уточка.mp3",       bg:"#FFE7A3", fg:"#6B4E00" },
      { label: "ط", img: "Птичка.png",       audio: "птичка.mp3",       bg:"#FFC3C3", fg:"#7A0000" },
      { label: "ح", img: "Лошадка.png",      audio: "лошадка.mp3",      bg:"#CFE5FF", fg:"#0A3D7A" },
      { label: "ض", img: "Лягушка.png",      audio: "лягушка.mp3",      bg:"#D7F7D7", fg:"#135B13" },
      { label: "ق", img: "Кошка.png",        audio: "кошка.mp3",        bg:"#E7DCFF", fg:"#3E1C7A" },
      { label: "ك", img: "Собачка.png",      audio: "собачка.mp3",      bg:"#FFFFFF", fg:"#111111" },
      { label: "خ", img: "Овечка 2.png",     audio: "овечка.mp3",       bg:"#111111", fg:"#FFFFFF" },
      { label: "س", img: "Рыбка.png",        audio: "рыбка.mp3",        bg:"#FFE9B8", fg:"#7A4B00" },
      { label: "ف", img: "Мышка.png",        audio: "мышка.mp3",        bg:"#D9F0FF", fg:"#0B4B6B" },
      { label: "ث", img: "Лиса.png",         audio: "лиса.mp3",         bg:"#FFD7B5", fg:"#7A2E00" },
      { label: "ذ", img: "Волк.png",         audio: "волк.mp3",         bg:"#E6E6E6", fg:"#1A1A1A" },
      { label: "م", img: "Учит.ельница.png", audio: "учительница.mp3",  bg:"#FFD6E7", fg:"#7A003A" },
      { label: "أ", img: "Дети.png",         audio: "дети.mp3",         bg:"#EAF7FF", fg:"#1A1A1A" },
    ];

    const lettersMobile = document.getElementById("letters-mobile");
    const lettersDesktop = document.getElementById("letters-desktop");
    const cardImage = document.getElementById("card-image");
    const audioEl = document.getElementById("letter-audio");
    const stopBtn = document.getElementById("stop-audio");

    const toggleNavBtn = document.getElementById("toggle-nav");
    const mobileNav = document.getElementById("mobile-nav");

    let activeIndex = 0;

    function stopAudio() {
      audioEl.pause();
      audioEl.currentTime = 0;
    }

    function setCard(index) {
      activeIndex = index;
      const item = book1[index];

      stopAudio();
      cardImage.src = encodeURI(item.img);
      cardImage.alt = item.label;
      audioEl.src = encodeURI(item.audio);
      audioEl.load();

      highlightAll();
    }

    function highlightAll() {
      document.querySelectorAll(".letter-btn").forEach((b, i) => {
        b.style.outline = i === activeIndex ? "2px solid rgba(0,0,0,0.25)" : "none";
      });
    }

    function makeLetterButton(l, i, isMobile) {
      const btn = document.createElement("button");
      btn.className = "letter-btn rounded-md flex items-center justify-center font-bold transition-all";
      btn.style.background = l.bg;
      btn.style.color = l.fg;
      btn.style.border = "1px solid rgba(0,0,0,0.08)";
      btn.textContent = l.label;
      btn.onclick = () => setCard(i);

      if (isMobile) {
        btn.classList.add("w-full", "aspect-square", "text-2xl");
      } else {
        btn.classList.add("w-full", "aspect-square", "text-3xl");
      }
      return btn;
    }

    function renderLetters() {
      lettersMobile.innerHTML = "";
      lettersDesktop.innerHTML = "";

      book1.forEach((l, i) => {
        lettersMobile.appendChild(makeLetterButton(l, i, true));
        lettersDesktop.appendChild(makeLetterButton(l, i, false));
      });
    }

    stopBtn.onclick = stopAudio;

    toggleNavBtn.onclick = () => {
      const hidden = mobileNav.classList.toggle("hidden");
      toggleNavBtn.textContent = hidden ? "Показать" : "Скрыть";
      cardImage.style.maxHeight = hidden ? "80vh" : "68vh";
    };

    // ✅ Доп. улучшение: если телефон в альбомном режиме — можно автоматически скрыть меню
    function autoHideNavOnLandscape() {
      const isMobile = window.matchMedia("(max-width: 767px)").matches;
      const isLandscape = window.matchMedia("(orientation: landscape)").matches;
      if (isMobile && isLandscape) {
        mobileNav.classList.add("hidden");
        toggleNavBtn.textContent = "Показать";
        cardImage.style.maxHeight = "80vh";
      }
    }
    window.addEventListener("resize", autoHideNavOnLandscape);

    renderLetters();
    setCard(0);
    autoHideNavOnLandscape();
  </script>
</body>
</html>
